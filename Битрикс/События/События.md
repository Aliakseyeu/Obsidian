
### Создание
- Настройки - Настройки продукта - Почтовые и СМС события - Типы событий
- Добавить событие
- Добавить почтовый шаблон к данному событию

---
### Использование переменных

В теле можно испjльзовать переменные. Например "#SITE_NAME\#: Подтверждение подписки", Которые передаются в C_FIELDS

---
### Вызов из кода

```php
Event::send([  
    'EVENT_NAME' => 'NEW_ADMIN',  
    'LID' => MY_SITE_ID,  
    'C_FIELDS' => [  
        'NAME' => $arParams['LAST_NAME']." ".$arParams['NAME'],  
        'EMAIL' => $arParams['EMAIL'],  
        'EMAIL_TO' => implode(',', $adminEmails)  
    ]]);
```

```php
Event::sendImmediate([  
   "EVENT_NAME" => "ELEMENTS_SUMMARY",  
   "LID" => MY_SITE_ID,  
   "C_FIELDS" => [  
      "ELEMENTS_COUNT" => count($result),  
      "ELEMENTS_TABLE" => $elementTable,  
   ],  
]);
```

---

Новый формат D7. Предпочтителен для работы с хайлоад блоками и ORM

```php
class SearchHistory  
{  
    public static function saveQuerySearchInfo(Event $event): EventResult  
    {        global $USER;  
  
        $fields = $event->getParameter('fields');  
  
        $changedFields = [];  
        $userId = (int)$USER->GetID();  
        if (!isset($fields['UF_USER_ID']) && $userId > 0) {  
            $changedFields['UF_USER_ID'] = $userId;  
        }  
        if (!isset($fields['UF_DATETIME'])) {  
            $changedFields['UF_DATETIME'] = new DateTime();  
        }  
  
        $result = new EventResult();  
        if (!empty($changedFields)) {  
            $result->modifyFields($changedFields);  
        }  
        return $result;  
    }  
}
```